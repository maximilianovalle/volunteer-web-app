<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">    <!-- icon library -->
    <title>Dashboard</title>

    <style>

        * {
            margin: 0px;
            padding: 0px;
        }

        body {
            min-height: 100vh;

            background-color: #f39600; /* for browsers that do not support gradients */
            background-image: linear-gradient(to right, #ec660c , #f39600);

            font-family: Arial, Helvetica, sans-serif;
        }

        #header {
            height: 5vh;    /* connected to #main height */
            min-height: 52px;

            display: flex;
            justify-content: space-between;
            padding: 0px 250px;
            align-items: center;

            background-color: #ecebeb;
            box-shadow: #ec660c;
        }

        #header h2:hover {
            cursor: pointer;
        }

        #header > div {
            height: 80%;
            width: 200px;

            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        #signOutBtn {
            height: 80%;
            width: 100px;

            background-color: #ec660c;
            color: white;
            font-size: 16px;

            border: 2px solid #ec660c;
            border-radius: 4px;
        }

        #signOutBtn:hover {
            background-color: white;
            color: #ec660c;

            cursor: pointer;
        }

        #main {
            min-height: 87vh;   /* connected to #header height */

            max-width: 1200px;  /* page side spacing */
            margin: 0px auto;

            margin-top: 4vh;
            margin-bottom: 4vh;

            color: #ffffff;
        }

        .iconStyle {
            font-size: 24px;
        }

        .iconBtn {
            border: none;
        }

        .iconBtn:hover {
            cursor: pointer;
            color: #ec660c;
        }

        #topText {
            font-weight: bold;

            padding-bottom: 8px;
            border-bottom: 2px solid #ecebeb;
            margin-bottom: 8px;

            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        #topText > h1 {
            font-size: 38px;
        }

        #buttonAlign {
            width: 100%;
            display: flex;
            justify-content: center;
        }

        #browseEventsBtn {
            border: none;
            border-radius: 6px;
            font-size: 20px;

            width: 200px;
            height: 48px;
            margin: 24px 0px;

            background-color: #ecebeb;
        }

        #browseEventsBtn:hover {
            cursor: pointer;
            background-color: #d8d8d8;
        }



        #upcomingEventsContainer {
            width: 100%;
            padding: 32px 24px;

            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            row-gap: 24px;
        }

        .upcomingEvent {
            background-color: #ecebeb;
            box-shadow: #ec660c;
            color: black;

            max-width: 250px;
            min-height: 300px;
            padding: 8px 12px;

            box-sizing: border-box;
            border-radius: 6px;

            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .eventHeader {
            width: 100%;
            margin: 0px auto;

            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .eventImage {
            max-width: 100%;
            max-height: 150px;
            margin: 8px 0px;
            border-radius: 4px;
        }

        .eventDate {
            font-weight: bold;
            margin-bottom: 4px;
        }

        .eventDescription {
            text-align: center;
            max-height: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
        }



        #pastEventsHeader {
            text-align: center;
            font-size: 28px;
            padding: 8px 0px;
            border-bottom: 2px solid #ecebeb;
        }
        
        #pastEventsContainer {
            width: 100%;
            padding: 32px 24px;

            display: grid;
            row-gap: 24px;
        }
        
        .pastEvent {
            background-color: #ecebeb;
            box-shadow: #ec660c;
            color: black;

            width: 60%;
            min-height: 125px;
            padding: 8px 12px;
            margin: 0px auto;

            box-sizing: border-box;
            border-radius: 6px;

            display: flex;
            align-items: center;
            justify-content: space-between;
            column-gap: 12px;
        }

        .eventTextContainer {
            min-height: 125px;
        }

        .pastEventImage {
            max-height: 125px;
            margin: 8px 0px;
            border-radius: 4px;
        }

        .pastEventDescription {
            max-height: 92px;
        }

    </style>

</head>



<!-- HTML -->



<body>

    <!-- header -->

    <div id="header">

        <h2 onclick="window.location.href='/volunteer-dashboard'">Placeholder</h2> <!-- !! -->

        <div> <!-- !! -->
            <button onclick="openNotifications()" class="iconBtn"><i class="iconStyle fa-solid fa-bell"></i></button>
            <button onclick="window.location.href='/user-manage-profile'" class="iconBtn"><i class="iconStyle fa-solid fa-user"></i></button>
            <button onclick="logout()" id="signOutBtn">Sign Out</button>
        </div>

    </div>

    <!-- main -->

    <div id="main">

        <!-- top text -->
        <div id="topText">
            <h1>Volunteer Dashboard</h1>    <!-- !! -->
            <p id="currDate">Today's Date</p>
        </div>

        <div id="buttonAlign">
            <button id="browseEventsBtn" onclick="window.location.href='/browse-events'">Browse Events <i class="iconStyle fa-solid fa-magnifying-glass"></i></button>
        </div>

        <h2>Hi, [Name]!</h2>
        <p>Here are your upcoming events...</p>

        <!-- upcoming events carousel -->
        <div id="upcomingEventsContainer">

            <!-- event -->
            <div class="upcomingEvent">

                <div class="eventHeader">
                    <h3>Event Name</h3>
                    <p>CA <i class="fa-solid fa-location-dot"></i></p>
                </div>

                <img class="eventImage" src="volunteer/event-images/event-all.jpg" alt="Event">

                <p class="eventDate">April 23, 2025</p>

                <p class="eventDescription">Event description, blah blah. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Event description, blah blah. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>

            </div>

        </div>

    </div>



    <!-- SCRIPT -->



    <script>

        // logout function

        async function logout() {
            // TODO: clear local storage/cookies ??

            window.location.href="/";
        }

        // notifications modal

        async function openNotifications() {
            // TODO: notifications modal
        }

        // current date

        const dateElement = document.getElementById("currDate");
        const today = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        const formattedDate = today.toLocaleDateString('en-US', options);
        dateElement.textContent = formattedDate;

        // display past events function

        async function fetchPastEvents() {
            try {
                const response = await fetch("http://localhost:3000/api/volunteer/past");
                const pastEvents = await response.json();

                const pastEventsList = document.getElementById("pastEventList");

                // if no past events

                if (pastEvents.length === 0) {
                    const li = document.createElement("li");
                    li.textContent = "No past events found!";
                    li.style.textAlign = "center";
                    pastEventsList.appendChild(li);
                }

                // for each past event

                pastEvents.forEach(event => {

                    const li = document.createElement("li");

                    const name = document.createElement("h3");
                    const comma = document.createElement("p");
                    const state = document.createElement("p");

                    const date = document.createElement("p");
                    const type = document.createElement("p");
                    const description = document.createElement("p");

                    const emptyDiv1 = document.createElement("div");
                    const emptyDiv2 = document.createElement("div");
                    const emptyDiv3 = document.createElement("div");

                    // li.textContent = `${event.Event_Name}`;

                    name.textContent = `${event.Event_Name}`;
                    comma.textContent = ",";
                    state.textContent = `${event.Location_State_Code}`;

                    date.textContent = new Date(event.Event_Date).toLocaleDateString("en-US");
                    type.textContent = `${event.Type}`;
                    description.textContent = `${event.Description}`;
                    apply.textContent = "Apply";

                    emptyDiv2.appendChild(name);
                    emptyDiv2.appendChild(comma);
                    emptyDiv2.appendChild(state);

                    emptyDiv2.style.display = "flex";

                    emptyDiv1.appendChild(emptyDiv2);
                    emptyDiv1.appendChild(type);

                    emptyDiv1.style.display = "flex";
                    emptyDiv1.style.justifyContent = "space-between";


                    li.appendChild(emptyDiv1);
                    li.appendChild(date);

                    emptyDiv3.appendChild(description);

                    emptyDiv3.style.display = "flex";
                    emptyDiv3.style.flexDirection = "column";
                    emptyDiv3.style.alignItems = "center";

                    li.append(emptyDiv3);

                    li.style.backgroundColor = "#ecebeb";
                    li.style.borderRadius = "12px";
                    li.style.padding = "8px 12px";

                    pastEventList.appendChild(li);

                });
            } catch (error) {
                console.error("Error fetching past events: ", error);
            }
        }

        // display current events function

        async function fetchCurrentEvents() {
            try {
                const response = await fetch("http://localhost:3000/api/volunteer/current");
                const currentEvents = await response.json();

                const currentEventsList = document.getElementById("currentEventList");

                // if no current events

                if (currentEvents.length === 0) {
                    const li = document.createElement("li");
                    li.textContent = "No events found!";
                    li.style.textAlign = "center";
                    pastEventsList.appendChild(li);
                }

                currentEvents.forEach(event => {
                
                    const li = document.createElement("li");

                    const name = document.createElement("h3");
                    const comma = document.createElement("p");
                    const state = document.createElement("p");

                    const date = document.createElement("p");
                    const type = document.createElement("p");
                    const description = document.createElement("p");

                    const emptyDiv1 = document.createElement("div");
                    const emptyDiv2 = document.createElement("div");
                    const emptyDiv3 = document.createElement("div");

                    const apply = document.createElement("button");

                    // li.textContent = `${event.Event_Name}`;

                    name.textContent = `${event.Event_Name}`;
                    comma.textContent = ",";
                    state.textContent = `${event.Location_State_Code}`;

                    date.textContent = new Date(event.Event_Date).toLocaleDateString("en-US");
                    type.textContent = `${event.Type}`;
                    description.textContent = `${event.Description}`;
                    apply.textContent = "Apply";

                    emptyDiv2.appendChild(name);
                    emptyDiv2.appendChild(comma);
                    emptyDiv2.appendChild(state);

                    emptyDiv2.style.display = "flex";

                    emptyDiv1.appendChild(emptyDiv2);
                    emptyDiv1.appendChild(type);

                    emptyDiv1.style.display = "flex";
                    emptyDiv1.style.justifyContent = "space-between";


                    li.appendChild(emptyDiv1);
                    li.appendChild(date);

                    emptyDiv3.appendChild(description);
                    emptyDiv3.appendChild(apply);

                    emptyDiv3.style.display = "flex";
                    emptyDiv3.style.flexDirection = "column";
                    emptyDiv3.style.alignItems = "center";

                    li.append(emptyDiv3);

                    li.style.backgroundColor = "#ecebeb";
                    li.style.borderRadius = "12px";
                    li.style.padding = "8px 12px";

                    currentEventsList.appendChild(li);

                });
            } catch (error) {
                console.error("Error fetching current events: ", error);
            }
        }

        // call functions when page loads

        fetchPastEvents();
        fetchCurrentEvents();

    </script>
    
</body>

</html>